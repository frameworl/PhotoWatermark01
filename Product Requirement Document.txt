# 产品需求文档：图片EXIF信息水印工具

## 1. 产品概述

### 1.1 产品名称
图片EXIF信息水印工具

### 1.2 产品描述
一款命令行程序，用于读取图片文件的EXIF信息中的拍摄时间，并将该时间作为文本水印添加到图片上。程序支持自定义水印的字体大小、颜色和位置，并将处理后的图片保存到指定目录。

## 2. 功能需求

### 2.1 核心功能

- **图片路径输入**
  - 用户通过命令行参数输入图片文件或目录路径
  - 支持单个文件和整个目录的批量处理

- **EXIF信息读取**
  - 读取图片文件的EXIF元数据
  - 提取拍摄时间信息（年月日格式）
  - 处理EXIF信息缺失的情况

- **水印自定义设置**
  - 字体大小设置
  - 字体颜色设置（支持RGB或预定义颜色）
  - 水印位置设置（左上角、居中、右下角等）

- **图片处理与保存**
  - 在原图片上绘制文本水印
  - 保存处理后的图片到新目录
  - 新目录命名为原目录名+"_watermark"，作为原目录的子目录

### 2.2 非功能性需求

- **兼容性**
  - 支持常见图片格式（JPEG、PNG等）
  - 跨平台支持（Windows、Linux、macOS）

- **性能要求**
  - 批量处理时保持合理的处理速度
  - 内存使用优化

## 3. 技术规格

### 3.1 开发方式
使用vibe coding方式进行开发

### 3.2 命令行接口设计

```bash
# 基本用法
photo_watermark [options] <image_path>

# 参数说明
# <image_path> : 图片文件路径或包含图片的目录路径

# 可选参数
# --font-size <size>     : 设置字体大小（默认值：12）
# --color <color>        : 设置字体颜色（默认值：white）
# --position <position>  : 设置水印位置（默认值：bottom-right）
```


### 3.3 水印位置选项
- `top-left`: 左上角
- `center`: 居中
- `bottom-right`: 右下角

### 3.4 输出规范
- 创建输出目录：`<原目录路径>/[原目录名]_watermark`
- 保持原文件名不变，仅更改保存路径

## 4. 用户流程

### 4.1 基本使用流程
1. 用户运行程序并提供图片路径
2. 程序读取指定路径下的所有图片文件
3. 对每个图片文件提取EXIF拍摄时间信息
4. 根据用户设置或默认设置应用水印样式
5. 将添加水印后的图片保存到_watermark目录

### 4.2 异常处理
- 图片文件不存在或无法访问时给出错误提示
- 图片不包含EXIF信息时跳过或使用默认时间
- 输出目录无法创建时给出错误提示

## 5. 验收标准

### 5.1 功能验收
- [ ] 正确读取图片EXIF信息中的拍摄时间
- [ ] 支持自定义字体大小、颜色和位置
- [ ] 水印正确绘制在图片上
- [ ] 处理后的图片正确保存到_watermark目录
- [ ] 支持批量处理目录中的多个图片文件

### 5.2 性能验收
- [ ] 单张图片处理时间不超过5秒
- [ ] 内存使用合理，无明显内存泄漏

### 5.3 兼容性验收
- [ ] 支持JPEG格式图片
- [ ] 在主流操作系统上正常运行

## 6. 项目交付物

### 6.1 可执行程序
- 编译完成的命令行程序
- 相关依赖库（如需要）

### 6.2 文档
- 用户使用手册
- 程序帮助信息（通过--help参数显示）

### 6.3 示例
- 使用示例和测试图片
- 典型使用场景的演示